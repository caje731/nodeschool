var urllib 	= require('url');
var http	= require('http');

var parsetime = function(iso_time){
	var datetime = new Date(iso_time);
	return {
			 'hour':datetime.getHours(),
			 'minute': datetime.getMinutes(),
			 'second': datetime.getSeconds()
			};
};
var unixtime = function(iso_time){
	return {
			'unixtime':(new Date(iso_time)).getTime()
			};
}
var server = http.createServer(function(req, res){
	parsed_req 	= urllib.parse(req.url, true);
	iso_time 	= parsed_req.query['iso'];
	endpoint	= parsed_req.pathname;
	res.writeHead(200, { 'Content-Type': 'application/json' });
	if(endpoint === '/api/parsetime'){
		res.end(JSON.stringify(parsetime(iso_time)));
	}
	else if(endpoint === '/api/unixtime'){
		res.end(JSON.stringify(unixtime(iso_time)));
	}
});
server.listen(process.argv[2]);